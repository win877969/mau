<!DOCTYPE html>
<html>
<head>
  <title>Proxy Aktif</title>
  <style>
    /* CSS */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    table th, table td {
      padding: 10px;
      text-align: left;
      border: 1px solid #ddd;
    }
    table tr:nth-child(even) {
      background-color: #f9f9f9; /* Warna untuk baris genap */
    }
    table tr:nth-child(odd) {
      background-color: #fff; /* Warna untuk baris ganjil */
    }
    table th {
      background-color: #007bff;
      color: white;
    }
    .copy-vless, .copy-trojan, .copy-ss {
      margin: 5px;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      background-color: #007bff;
      color: #fff;
      cursor: pointer;
    }
    .copy-vless:hover, .copy-trojan:hover, .copy-ss:hover {
      background-color: #0069d9;
    }
    .pagination {
      text-align: center;
    }
    .pagination button {
      margin: 2px;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      background-color: #007bff;
      color: #fff;
      cursor: pointer;
    }
    .pagination button:hover {
      background-color: #0069d9;
    }
    .pagination .active {
      background-color: #0056b3;
    }
    #search-bar {
      margin-bottom: 20px;
      padding: 10px;
      width: 100%;
      max-width: 400px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <h1>Proxy Aktif:</h1>
  <input type="text" id="search-bar" placeholder="Cari berdasarkan negara, ISP, atau penyedia layanan...">
  <table>
    <thead>
      <tr>
        <th>Negara</th>
        <th>Penyedia</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody id="proxy-list"></tbody>
  </table>
  <div class="pagination" id="pagination"></div>

  <script>
        function checkProxy(ip, port) {
  const testUrl = `https://${ip}:${port}`; // URL untuk melakukan tes proxy
  return fetch(testUrl, { method: 'HEAD', mode: 'no-cors' })
    .then(() => true) // Proxy aktif
    .catch(() => false); // Proxy tidak aktif
}

function renderProxies(proxies, proxyList, pagination) {
  const start = (currentPage - 1) * proxyPerPage;
  const end = start + proxyPerPage;
  const currentPageProxies = proxies.slice(start, end);

  proxyList.innerHTML = ''; // Hapus semua elemen sebelumnya

  currentPageProxies.forEach(async proxy => {
    const [ip, port, negara, penyedia] = proxy.split(",");
    const uuid = uuidv4();
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${negara}</td>
      <td>${penyedia}</td>
      <td>
        <button class="copy-vless">Copy VLESS</button>
        <button class="copy-trojan">Copy TROJAN</button>
        <button class="copy-ss">Copy SS</button>
        <button class="check-proxy">Cek Proxy</button>
      </td>
    `;
    proxyList.appendChild(row);

    row.querySelector('.copy-vless').addEventListener('click', () => {
      navigator.clipboard.writeText(`vless://${uuid}@tp1.bmkg.xyz:443?encryption=none&type=ws&host=tp1.bmkg.xyz&path=%2F${ip}-${port}&security=tls&sni=tp1.bmkg.xyz#${negara}+${penyedia}`);
      alert('COPY VLESS SUKSES!');
    });

    row.querySelector('.copy-trojan').addEventListener('click', () => {
      navigator.clipboard.writeText(`trojan://${uuid}@tp1.bmkg.xyz:443?encryption=none&type=ws&host=tp1.bmkg.xyz&path=%2F${ip}-${port}&security=tls&sni=tp1.bmkg.xyz#${negara}+${penyedia}`);
      alert('COPY TROJAN SUKSES!');
    });

    row.querySelector('.copy-ss').addEventListener('click', () => {
      navigator.clipboard.writeText(`ss://${uuid}@tp1.bmkg.xyz:443?encryption=none&type=ws&host=tp1.bmkg.xyz&path=%2F${ip}-${port}&security=tls&sni=tp1.bmkg.xyz#${negara}+${penyedia}`);
      alert('COPY SS SUKSES!');
    });

    // Cek Proxy
    const checkButton = row.querySelector('.check-proxy');
    checkButton.addEventListener('click', async () => {
      checkButton.textContent = 'Memeriksa...';
      const isActive = await checkProxy(ip, port);
      checkButton.textContent = isActive ? 'Proxy Aktif' : 'Proxy Tidak Aktif';
      alert(isActive ? 'Proxy ini AKTIF!' : 'Proxy ini TIDAK AKTIF!');
    });
  });

  renderPagination(proxies, pagination);
}

  </script>
</body>
</html>
